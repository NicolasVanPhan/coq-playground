<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>v2</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library v2</h1>

<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Mycrush.html#"><span class="id" title="library">Mycrush</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Bool</span> <span class="id" title="library">String</span> <span class="id" title="library">List</span> <span class="id" title="library">Arith</span> <span class="id" title="library">NArith</span> <span class="id" title="library">Ascii</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Vectors.Vector</span>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">N_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a id="bit" class="idref" href="#bit"><span class="id" title="definition, inductive"><span id="bit_rect" class="id"><span id="bit_ind" class="id"><span id="bit_rec" class="id"><span id="bit_sind" class="id">bit</span></span></span></span></span></a> : <span class="id" title="keyword">Set</span> :=<br/>
| <a id="b0" class="idref" href="#b0"><span class="id" title="constructor">b0</span></a> : <a class="idref" href="v2.html#bit:1"><span class="id" title="inductive">bit</span></a><br/>
| <a id="b1" class="idref" href="#b1"><span class="id" title="constructor">b1</span></a> : <a class="idref" href="v2.html#bit:1"><span class="id" title="inductive">bit</span></a>.<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

Let's think on paper before proving.
You want a function to translate between the <span class="inlinecode"><span class="id" title="var">N</span></span> and <span class="inlinecode"><span class="id" title="var">Vector.t</span></span> <span class="inlinecode"><span class="id" title="var">bool</span></span> representation of this value.

<div class="paragraph"> </div>

Take 26 as an example :
16 + 8 + 2 = 26 = 0x1A = 0b11010

<div class="paragraph"> </div>

The <span class="inlinecode"><span class="id" title="var">N</span></span> representation is xO xI xO xI xI (like the binary representation, but LSB first)

<div class="paragraph"> </div>

The reversed Vector.t representation would be <span class="inlinecode"><span class="id" title="var">bO</span></span> <span class="inlinecode"><span class="id" title="var">bI</span></span> <span class="inlinecode"><span class="id" title="var">bO</span></span> <span class="inlinecode"><span class="id" title="var">bI</span></span> <span class="inlinecode"><span class="id" title="var">bI</span></span>

<div class="paragraph"> </div>

<pre>
(Vector.cons _ b0 _ 
(Vector.cons _ b1 _ 
(Vector.cons _ b0 _ 
(Vector.cons _ b1 _ 
(Vector.cons _ b1 _
(Vector.nil  _ )))))).
</pre>

<div class="paragraph"> </div>

how to translate :

<div class="paragraph"> </div>

26 = 0 + 2 + 8 + 16
   = 0 + 2^1 + 2^3 + 2^4

<div class="paragraph"> </div>

vec_of_N(0N,  5) = <span class="inlinecode"><span class="id" title="var">b1</span></span> <span class="inlinecode"><span class="id" title="var">b0</span></span> <span class="inlinecode"><span class="id" title="var">b0</span></span> <span class="inlinecode"><span class="id" title="var">b0</span></span> <span class="inlinecode"><span class="id" title="var">b0</span></span>
vec_of_N(26
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="vec_of_pos" class="idref" href="#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> (<a id="w:3" class="idref" href="#w:3"><span class="id" title="binder">w</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="p_opt:4" class="idref" href="#p_opt:4"><span class="id" title="binder">p_opt</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#positive"><span class="id" title="inductive">positive</span></a>) : <span class="id" title="inductive">Vector.t</span> <a class="idref" href="v2.html#bit"><span class="id" title="inductive">bit</span></a> <a class="idref" href="v2.html#w:3"><span class="id" title="variable">w</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="v2.html#p_opt:4"><span class="id" title="variable">p_opt</span></a>, <a class="idref" href="v2.html#w:3"><span class="id" title="variable">w</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>           , <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a>    ⇒ <span class="id" title="constructor">Vector.nil</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>        , <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">w'</span> ⇒ <span class="id" title="constructor">Vector.cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="v2.html#vec_of_pos:5"><span class="id" title="definition">vec_of_pos</span></a> <span class="id" title="var">w'</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#xH"><span class="id" title="constructor">xH</span></a>)   , <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">w'</span> ⇒ <span class="id" title="constructor">Vector.cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="v2.html#vec_of_pos:5"><span class="id" title="definition">vec_of_pos</span></a> <span class="id" title="var">w'</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#xO"><span class="id" title="constructor">xO</span></a> <span class="id" title="var">p'</span>), <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">w'</span> ⇒ <span class="id" title="constructor">Vector.cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="v2.html#vec_of_pos:5"><span class="id" title="definition">vec_of_pos</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">p'</span>))<br/>
&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#xI"><span class="id" title="constructor">xI</span></a> <span class="id" title="var">p'</span>), <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">w'</span> ⇒ <span class="id" title="constructor">Vector.cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="v2.html#vec_of_pos:5"><span class="id" title="definition">vec_of_pos</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">p'</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="vec_of_pos_sanity0" class="idref" href="#vec_of_pos_sanity0"><span class="id" title="lemma">vec_of_pos_sanity0</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="p:8" class="idref" href="#p:8"><span class="id" title="binder">p</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#positive"><span class="id" title="inductive">positive</span></a>, <a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> 0 (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="v2.html#p:8"><span class="id" title="variable">p</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="constructor">Vector.nil</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
TODO : Why must I destruct <span class="inlinecode"><span class="id" title="var">p</span></span> here ?? Result should evaluate to <span class="inlinecode"><span class="id" title="var">nil</span></span> without even looking at <span class="inlinecode"><span class="id" title="var">p</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="vec_of_pos_sanity1" class="idref" href="#vec_of_pos_sanity1"><span class="id" title="lemma">vec_of_pos_sanity1</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> 1 (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#xH"><span class="id" title="constructor">xH</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> (<span class="id" title="constructor">nil</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="vec_of_pos_sanity2" class="idref" href="#vec_of_pos_sanity2"><span class="id" title="lemma">vec_of_pos_sanity2</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> 3 (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="constructor">nil</span> <span class="id" title="var">_</span> ))).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="vec_of_pos_sanity3" class="idref" href="#vec_of_pos_sanity3"><span class="id" title="lemma">vec_of_pos_sanity3</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> 3 (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#xO"><span class="id" title="constructor">xO</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#xI"><span class="id" title="constructor">xI</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#xH"><span class="id" title="constructor">xH</span></a>)))) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a> <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="constructor">nil</span> <span class="id" title="var">_</span> )))<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="vec_of_pos_sanity4" class="idref" href="#vec_of_pos_sanity4"><span class="id" title="lemma">vec_of_pos_sanity4</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> 5 (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#xO"><span class="id" title="constructor">xO</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#xI"><span class="id" title="constructor">xI</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#xH"><span class="id" title="constructor">xH</span></a>)))) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a> <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="constructor">nil</span> <span class="id" title="var">_</span> )))))<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Now let's wrap it in <span class="inlinecode"><span class="id" title="var">vec_of_N</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="vec_zeroes" class="idref" href="#vec_zeroes"><span class="id" title="definition">vec_zeroes</span></a> (<a id="w:9" class="idref" href="#w:9"><span class="id" title="binder">w</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <span class="id" title="inductive">Vector.t</span> <a class="idref" href="v2.html#bit"><span class="id" title="inductive">bit</span></a> <a class="idref" href="v2.html#w:9"><span class="id" title="variable">w</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="v2.html#w:9"><span class="id" title="variable">w</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> ⇒ <span class="id" title="constructor">Vector.nil</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">w'</span> ⇒ <span class="id" title="constructor">Vector.cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> (<a class="idref" href="v2.html#vec_zeroes:10"><span class="id" title="definition">vec_zeroes</span></a> <span class="id" title="var">w'</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="vec_zeroes_sanity0" class="idref" href="#vec_zeroes_sanity0"><span class="id" title="lemma">vec_zeroes_sanity0</span></a> : <a class="idref" href="v2.html#vec_zeroes"><span class="id" title="definition">vec_zeroes</span></a> 0 <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="constructor">Vector.nil</span> <span class="id" title="var">_</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Theorem</span> <a id="vec_zeroes_sanity3" class="idref" href="#vec_zeroes_sanity3"><span class="id" title="lemma">vec_zeroes_sanity3</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#vec_zeroes"><span class="id" title="definition">vec_zeroes</span></a> 3 <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a> <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="constructor">nil</span> <span class="id" title="var">_</span> )))<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="vec_of_N" class="idref" href="#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> (<a id="w:12" class="idref" href="#w:12"><span class="id" title="binder">w</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="n:13" class="idref" href="#n:13"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>) : <span class="id" title="inductive">Vector.t</span> <a class="idref" href="v2.html#bit"><span class="id" title="inductive">bit</span></a> <a class="idref" href="v2.html#w:12"><span class="id" title="variable">w</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="v2.html#n:13"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#N0"><span class="id" title="constructor">N0</span></a> ⇒ <a class="idref" href="v2.html#vec_zeroes"><span class="id" title="definition">vec_zeroes</span></a> <a class="idref" href="v2.html#w:12"><span class="id" title="variable">w</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#Npos"><span class="id" title="constructor">Npos</span></a> <span class="id" title="var">p</span> ⇒ <a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> <a class="idref" href="v2.html#w:12"><span class="id" title="variable">w</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Eval</span> <span class="id" title="tactic">compute</span> <span class="id" title="tactic">in</span> <a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> 5 26.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="vec_of_N_sanity_26" class="idref" href="#vec_of_N_sanity_26"><span class="id" title="lemma">vec_of_N_sanity_26</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> 5 26 <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <br/>
&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a> <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">nil</span> <span class="id" title="var">_</span>)))))<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="vec_of_N_sanity_26_ext" class="idref" href="#vec_of_N_sanity_26_ext"><span class="id" title="lemma">vec_of_N_sanity_26_ext</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> 7 26 <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <br/>
&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a> <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">nil</span> <span class="id" title="var">_</span>)))))))<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="vec_of_N_sanity_26_trunc" class="idref" href="#vec_of_N_sanity_26_trunc"><span class="id" title="lemma">vec_of_N_sanity_26_trunc</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> 3 26 <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <br/>
&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a> <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">nil</span> <span class="id" title="var">_</span> )))<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Alright, seems good so far ! Let's write the reverse now.

<div class="paragraph"> </div>

How would it work ?
Let's write the spec in terms of clauses f(x) = y as above.

<div class="paragraph"> </div>

f = N_of_vec

<div class="paragraph"> </div>

f(b0, 1) = 0 = N0
f(b0 b1 b0 b1 b1, 5) = 26 = Npos (xO xI xO xI xH)

<div class="paragraph"> </div>

Let's try to make a recursive pattern appear :
<pre>
f(   b1 b0 b1 b1, 4) = 13 = 26 / 2 
f(      b0 b1 b1, 3) = 6  = 13 / 2
f(         b1 b1, 2) = 3  = 6  / 2
f(            b1, 1) = 1  = 3  / 2
</pre>

<div class="paragraph"> </div>

So :
<pre>
f(b0 b1 b0 b1 b1, 5) = 26 
  = 2 * 13
  = 2 * f(b1 b0 b1 b1, 4)
  = 2 * (1 + 2 * 6)
  = 2 * (1 + 2 * f(b0 b1 b1, 3))
  = 0 + 2 * (1 + 2 * f(b0 b1 b1, 3))
  = 0 + 2 * (1 + 2 * (0 + 2 * f(b1 b1, 2)))
  = 0 + 2 * (1 + 2 * (0 + 2 * (1 + 2 * f(b1, 1)))))
  = 0 + 2 * (1 + 2 * (0 + 2 * (1 + 2 * (1 + 2 * f(nil, 0)))))
  = 0 + 2 * (1 + 2 * (0 + 2 * (1 + 2 * (1 + 2 * 0)))))
  = 0 + 2 * (1 + 2 * (0 + 2 * (1 + 2 * 1)))))
  = 0 + 2 * (1 + 2 * (0 + 2 * (1 + 2)))))
  = 0 + 2 * (1 + 2 * (0 + 2 * 3))
  = 0 + 2 * (1 + 2 * 6)
  = 0 + 2 * (1 + 12)
  = 0 + 2 * 13
  = 26
</pre>

<div class="paragraph"> </div>

And we can see the recursive pattern emerge :
<pre>
A: f(b :: bs, S w) = b + 2 * f(bs, w)
</pre>

<div class="paragraph"> </div>

with the base case :
<pre>
B: f(b, 0) = 0
</pre>

<div class="paragraph"> </div>

Note : To terminate recursion 1 step earlier, we can also state :
<pre>
B': f(b, 1) = b
</pre>
But it's not necessary here
-- What happens on vectors with leading zeroes ?

<div class="paragraph"> </div>

<pre>
f(b0 b1 b0 b1 b1 b0 b0, 7) = 26
 = 0 + 2 * f(b1 b0 b1 b1 b0 b0, 6)
 = ...
 = 0 + 2 * (1 + 2 * (0 + 2 * (1 + 2 * f(b1 b0 b0, 3)  )))))
 = 0 + 2 * (1 + 2 * (0 + 2 * (1 + 2 * 1 + f(b0 b0, 2) )))))
</pre>

<div class="paragraph"> </div>

For the sum to be correct, f(b0 b0, 2) must be zero.
But if we continue unrolling f with the pattern we saw, it IS zero :
<pre>
f(b0 b0, 2) = 0 + 2 * f(b0, 1)
            = 0 + 2 * (0 + 2 * 0 + (2 * f(nil, 0)))
            = 0 + 2 * (0 + 2 * 0 + (2 * 0)))
            = 0
</pre>

<div class="paragraph"> </div>

So it seems we're good with only clauses A and B.
-- What happens on trimmed vectors ?

<div class="paragraph"> </div>

For vec_of_N, we could give a big N to convert into a small vector,
such that the N is trimmed.
In our case, N_of_vec, the size of the vec equals the number of its elements,
by definition, so there is no such problem.

<div class="paragraph"> </div>

Looks like A and B do the job, let's implement it.

<div class="paragraph"> </div>

Remember :
<pre>
A: f(b :: bs, S w) = b + 2 * f(bs, w)
B: f(b, 0) = 0
</pre>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="b2n" class="idref" href="#b2n"><span class="id" title="definition">b2n</span></a> (<a id="b:15" class="idref" href="#b:15"><span class="id" title="binder">b</span></a> : <a class="idref" href="v2.html#bit"><span class="id" title="inductive">bit</span></a>) : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="v2.html#b:15"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> ⇒ 0%<span class="id" title="var">N</span><br/>
&nbsp;&nbsp;| <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> ⇒ 1%<span class="id" title="var">N</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="N_of_vec" class="idref" href="#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> (<a id="w:17" class="idref" href="#w:17"><span class="id" title="binder">w</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="v:18" class="idref" href="#v:18"><span class="id" title="binder">v</span></a> : <span class="id" title="inductive">Vector.t</span> <a class="idref" href="v2.html#bit"><span class="id" title="inductive">bit</span></a> <a class="idref" href="v2.html#w:17"><span class="id" title="variable">w</span></a>) : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="v2.html#v:18"><span class="id" title="variable">v</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="constructor">Vector.nil</span> <span class="id" title="var">_</span> ⇒ 0%<span class="id" title="var">N</span><br/>
&nbsp;&nbsp;| <span class="id" title="constructor">Vector.cons</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span> <span class="id" title="var">w'</span> <span class="id" title="var">v'</span> ⇒ <a class="idref" href="v2.html#b2n"><span class="id" title="definition">b2n</span></a> <span class="id" title="var">b</span> <span class="id" title="notation">+</span> 2 <span class="id" title="notation">×</span> <span class="id" title="notation">(</span><a class="idref" href="v2.html#N_of_vec:19"><span class="id" title="definition">N_of_vec</span></a> <span class="id" title="var">w'</span> <span class="id" title="var">v'</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="N_of_vec_sanity_26" class="idref" href="#N_of_vec_sanity_26"><span class="id" title="lemma">N_of_vec_sanity_26</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">nil</span> <span class="id" title="var">_</span>)))))) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 26%<span class="id" title="var">N</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="N_of_vec_sanity_26_ext" class="idref" href="#N_of_vec_sanity_26_ext"><span class="id" title="lemma">N_of_vec_sanity_26_ext</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;( <span class="id" title="constructor">nil</span> <span class="id" title="var">_</span>)))))))) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 26%<span class="id" title="var">N</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="N_of_vec_sanity_1" class="idref" href="#N_of_vec_sanity_1"><span class="id" title="lemma">N_of_vec_sanity_1</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <span class="id" title="var">_</span> ( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">_</span> (<span class="id" title="constructor">nil</span> <span class="id" title="var">_</span>)) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 1%<span class="id" title="var">N</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="N_of_vec_sanity_0" class="idref" href="#N_of_vec_sanity_0"><span class="id" title="lemma">N_of_vec_sanity_0</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <span class="id" title="var">_</span> ( <span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">_</span> (<span class="id" title="constructor">nil</span> <span class="id" title="var">_</span>)) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0%<span class="id" title="var">N</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="N_of_vec_sanity_nil" class="idref" href="#N_of_vec_sanity_nil"><span class="id" title="lemma">N_of_vec_sanity_nil</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <span class="id" title="var">_</span> (<span class="id" title="constructor">nil</span> <span class="id" title="var">_</span>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0%<span class="id" title="var">N</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Now let's see how hard it is to prove the roundtrip 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="N_vec_roundtrip_v1" class="idref" href="#N_vec_roundtrip_v1"><span class="id" title="lemma">N_vec_roundtrip_v1</span></a> : <span class="id" title="keyword">∀</span> <a id="w:21" class="idref" href="#w:21"><span class="id" title="binder">w</span></a>, <span class="id" title="keyword">∀</span> <a id="v:22" class="idref" href="#v:22"><span class="id" title="binder">v</span></a> : <span class="id" title="inductive">Vector.t</span> <a class="idref" href="v2.html#bit"><span class="id" title="inductive">bit</span></a> <a class="idref" href="v2.html#w:21"><span class="id" title="variable">w</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> <span class="id" title="var">_</span> (<a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <span class="id" title="var">_</span> <a class="idref" href="v2.html#v:22"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="v2.html#v:22"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Print</span> <span class="id" title="var">N_of_vec</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Print</span> <span class="id" title="var">vec_of_N</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
</div>

<div class="doc">
Here we're stuck with this goal :
<pre>
vec_of_N (S n) (N_of_vec (S n) (cons bit h n v)) = cons bit h n v
</pre>
let's draft on paper see if it's true or not :
We start from the left side, and try succesive rewrites until we reach the right side.

<div class="paragraph"> </div>

Lemma 1 :
(N_of_vec (S n) (cons bit h n v)) 
  = b2n h + 2 * N_of_vec n v

<div class="paragraph"> </div>

So  :

<div class="paragraph"> </div>

<pre>
left-side 
= vec_of_N (S n) (N_of_vec (S n) (cons bit h n v)) 
= vec_of_N (S n) (b2n h + 2 * N_of_vec n v) 
= vec_of_N (S n) (b2n h + 2 * N_of_vec n v) 
</pre>

<div class="paragraph"> </div>

We can't go further here, but notice a key truth that would help.
With a bit of boolean arithmetic, we can find out :

<div class="paragraph"> </div>

Lemma 2 :
<pre>
vec_of_N _ (b + 2 * v) = cons _ b (vec_of_N _ v)
</pre>

<div class="paragraph"> </div>

so :
<pre>
  vec_of_n (s n) (n_of_vec (s n) (cons bit h n v)) 
= vec_of_n (s n) (b2n h + 2 * n_of_vec n v)     (lemma 1)
= vec_of_n (s n) (b2n h + 2 * n_of_vec n v) 
= vec_of_n (s n) (b2n h + 2 * n_of_vec n v) 
= cons (h)  (vec_of_n _ (n_of_vec n v)          (lemma 2)
= cons (h)  (v)                                 (ih)
</pre>

<div class="paragraph"> </div>

And here we are !

<div class="paragraph"> </div>

With hindsight, we want to write a proof involving two functions,
and the prove can only go by induction.
But :
<ul class="doclist">
<li> N_of_vec  is 'linked' to its recursive call through a <span class="inlinecode"><span class="id" title="var">cons</span></span> relationship.

</li>
<li> vec_of_N  is 'linked' to its recursive call through a <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">+</span> <span class="inlinecode">2</span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">_</span></span> relationship.

</li>
</ul>

<div class="paragraph"> </div>

So, if we want to do induction on both,
we funamentally need a link between <span class="inlinecode"><span class="id" title="var">cons</span></span> and <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">+</span> <span class="inlinecode">2</span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">_</span></span>.
That's why we need those lemma.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lemma1" class="idref" href="#lemma1"><span class="id" title="lemma">lemma1</span></a> : <span class="id" title="keyword">∀</span> <a id="w:23" class="idref" href="#w:23"><span class="id" title="binder">w</span></a>, <span class="id" title="keyword">∀</span> <a id="v:24" class="idref" href="#v:24"><span class="id" title="binder">v</span></a> : <span class="id" title="inductive">Vector.t</span> <a class="idref" href="v2.html#bit"><span class="id" title="inductive">bit</span></a> <a class="idref" href="v2.html#w:23"><span class="id" title="variable">w</span></a>,<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="b:25" class="idref" href="#b:25"><span class="id" title="binder">b</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <span class="id" title="var">_</span> (<span class="id" title="constructor">cons</span> <a class="idref" href="v2.html#bit"><span class="id" title="inductive">bit</span></a> <a class="idref" href="v2.html#b:25"><span class="id" title="variable">b</span></a> <span class="id" title="var">_</span> <a class="idref" href="v2.html#v:24"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">(</span><a class="idref" href="v2.html#b2n"><span class="id" title="definition">b2n</span></a> <a class="idref" href="v2.html#b:25"><span class="id" title="variable">b</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">+</span> <span class="id" title="notation">(</span>2%<span class="id" title="var">N</span> <span class="id" title="notation">×</span> <span class="id" title="notation">(</span><a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <span class="id" title="var">_</span> <a class="idref" href="v2.html#v:24"><span class="id" title="variable">v</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="vec_z" class="idref" href="#vec_z"><span class="id" title="lemma">vec_z</span></a> : <span class="id" title="keyword">∀</span> <a id="w:26" class="idref" href="#w:26"><span class="id" title="binder">w</span></a>, <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> <a class="idref" href="v2.html#w:26"><span class="id" title="variable">w</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="v2.html#vec_zeroes"><span class="id" title="definition">vec_zeroes</span></a> <a class="idref" href="v2.html#w:26"><span class="id" title="variable">w</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">w</span>; <span class="id" title="var">crush</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lemma2" class="idref" href="#lemma2"><span class="id" title="lemma">lemma2</span></a> : <span class="id" title="keyword">∀</span> (<a id="w:27" class="idref" href="#w:27"><span class="id" title="binder">w</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="b:28" class="idref" href="#b:28"><span class="id" title="binder">b</span></a> : <a class="idref" href="v2.html#bit"><span class="id" title="inductive">bit</span></a>) (<a id="n:29" class="idref" href="#n:29"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="v2.html#w:27"><span class="id" title="variable">w</span></a>) (<span class="id" title="notation">(</span><a class="idref" href="v2.html#b2n"><span class="id" title="definition">b2n</span></a> <a class="idref" href="v2.html#b:28"><span class="id" title="variable">b</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">+</span> 2 <span class="id" title="notation">×</span> <a class="idref" href="v2.html#n:29"><span class="id" title="variable">n</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="constructor">Vector.cons</span> <a class="idref" href="v2.html#bit"><span class="id" title="inductive">bit</span></a> <a class="idref" href="v2.html#b:28"><span class="id" title="variable">b</span></a> <a class="idref" href="v2.html#w:27"><span class="id" title="variable">w</span></a> (<a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> <a class="idref" href="v2.html#w:27"><span class="id" title="variable">w</span></a> <a class="idref" href="v2.html#n:29"><span class="id" title="variable">n</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="v2.html#vec_z"><span class="id" title="lemma">vec_z</span></a>; <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="N_vec_roundtrip_" class="idref" href="#N_vec_roundtrip_"><span class="id" title="lemma">N_vec_roundtrip_</span></a> : <span class="id" title="keyword">∀</span> <a id="w:30" class="idref" href="#w:30"><span class="id" title="binder">w</span></a>, <span class="id" title="keyword">∀</span> <a id="v:31" class="idref" href="#v:31"><span class="id" title="binder">v</span></a> : <span class="id" title="inductive">Vector.t</span> <a class="idref" href="v2.html#bit"><span class="id" title="inductive">bit</span></a> <a class="idref" href="v2.html#w:30"><span class="id" title="variable">w</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> <span class="id" title="var">_</span> (<a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <span class="id" title="var">_</span> <a class="idref" href="v2.html#v:31"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="v2.html#v:31"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<br/>
</div>

<div class="doc">
Remember the outline of the proof :
<pre>
  vec_of_n (s n) (n_of_vec (s n) (cons bit h n v)) 
= vec_of_n (s n) (b2n h + 2 * n_of_vec n v)     (lemma 1)
= vec_of_n (s n) (b2n h + 2 * n_of_vec n v) 
= cons (h)  (vec_of_n _ (n_of_vec n v)          (lemma 2)
= cons (h)  (v)                                 (IH)
</pre>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="v2.html#lemma1"><span class="id" title="lemma">lemma1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="v2.html#lemma2"><span class="id" title="lemma">lemma2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
  Now the other way around, from N to vec and back.
  Let's outline the proof of N_of_vec _ (vec_of_N _ n) = n

<div class="paragraph"> </div>

  First, is it true ?
  <span class="inlinecode"><span class="id" title="var">n</span></span> can encode any number up to infinity, but vec cannot, it's limited by its width.
  imagine encoding 255 to a 3-bit vector, you'll get <span class="inlinecode">1;</span> <span class="inlinecode">1;</span> <span class="inlinecode">1</span>,
  which coverts back to 7 (and not 255).
  In the roundtrip, the 'bits above the MSB' are lost.

<div class="paragraph"> </div>

  We should re-state the theorem to account for this.
  But how will we restate it ?
  Let's first try to write the inductive proof to see which rewrite will best suit the proof.

<div class="paragraph"> </div>

  N_of_vec _ (vec_of_N _ n)
= N_of_vec _ (vec_of_pos _ p)    // ignoring the N0 case here as it will be trivial.

<div class="paragraph"> </div>

We'll have 5 case to handle now, because of the 5 clauses in the <span class="inlinecode"><span class="id" title="var">vec_of_pos</span></span> match statement.
<hr/>
 case 1 - width 0

<div class="paragraph"> </div>

...
= N_of_vec _ (vec_of_pos 0 p)   
= N_of_vec _ (Vector.nil))   
= N_of_vec _ (Vector.nil))   
= 0N      + 2 * 0N
= Npos (xH)
= Npos (p)
QED !
<hr/>
 case 4 : p = x0 p'

<div class="paragraph"> </div>

IH : N_of_vec _ (vec_of_pos _ (Some p')) = Npos p'

<div class="paragraph"> </div>

left
= N_of_vec (S w') (vec_of_pos (S w') (Some x0 p'))   
= N_of_vec (S w') (Vector.cons _ b0 w' (vec_of_pos (Some p')))   // eval vec_of_pos
= (b2n b0) w' + 2 * (N_of_vec (vec_of_pos (Some p')))            // eval vec_of_pos
= 0N + 2 * (Npos p')                                            // IH
= 1 + 2 * (Npos p')                                              // 0 + x = x
= Npos (x1 p')                                                   // some other trivial unnamed lemma 
= Npos p
QED

<div class="paragraph"> </div>


<div class="paragraph"> </div>


<div class="paragraph"> </div>

We can start with the little lemma :

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="n_of_zeroes" class="idref" href="#n_of_zeroes"><span class="id" title="lemma">n_of_zeroes</span></a> : <span class="id" title="keyword">∀</span> <a id="w:32" class="idref" href="#w:32"><span class="id" title="binder">w</span></a>, <a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <a class="idref" href="v2.html#w:32"><span class="id" title="variable">w</span></a> (<a class="idref" href="v2.html#vec_zeroes"><span class="id" title="definition">vec_zeroes</span></a> <a class="idref" href="v2.html#w:32"><span class="id" title="variable">w</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0%<span class="id" title="var">N</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHw</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Lia</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="annoying_precond_xO" class="idref" href="#annoying_precond_xO"><span class="id" title="lemma">annoying_precond_xO</span></a> : <span class="id" title="keyword">∀</span> <a id="p:33" class="idref" href="#p:33"><span class="id" title="binder">p</span></a> <a id="w:34" class="idref" href="#w:34"><span class="id" title="binder">w</span></a>,<br/>
&nbsp;&nbsp;<span class="id" title="abbreviation">N.pos</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#xO"><span class="id" title="constructor">xO</span></a> <a class="idref" href="v2.html#p:33"><span class="id" title="variable">p</span></a>) <span class="id" title="notation">&lt;</span> 2 <span class="id" title="notation">^</span> <span class="id" title="definition">N.of_nat</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="v2.html#w:34"><span class="id" title="variable">w</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">N.pos</span> <a class="idref" href="v2.html#p:33"><span class="id" title="variable">p</span></a> <span class="id" title="notation">&lt;</span> 2 <span class="id" title="notation">^</span> <span class="id" title="notation">(</span><span class="id" title="definition">N.of_nat</span> <a class="idref" href="v2.html#w:34"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="abbreviation">N.pos</span> <span class="id" title="var">p</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.BinNums.PosDef.html#35713fcadfdd66af247cbf95acf859fa"><span class="id" title="notation">~0</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 2 <span class="id" title="notation">×</span> <span class="id" title="notation">(</span><span class="id" title="abbreviation">N.pos</span> <span class="id" title="var">p</span><span class="id" title="notation">)</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="var">nia</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="keyword">∀</span> <a id="x:35" class="idref" href="#x:35"><span class="id" title="binder"><span id="x:36" class="id">x</span></span></a>, <span class="id" title="definition">N.succ</span> (<span class="id" title="definition">N.of_nat</span> <a class="idref" href="v2.html#x:35"><span class="id" title="variable">x</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">N.of_nat</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="v2.html#x:35"><span class="id" title="variable">x</span></a>)).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span>. <span class="id" title="var">nia</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">Hrw</span> <span class="id" title="var">w</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : 2 <span class="id" title="notation">^</span> <span class="id" title="definition">N.succ</span> (<span class="id" title="definition">N.of_nat</span> <span class="id" title="var">w</span>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 2 <span class="id" title="notation">×</span> <span class="id" title="notation">(</span>2 <span class="id" title="notation">^</span> <span class="id" title="definition">N.of_nat</span> <span class="id" title="var">w</span><span class="id" title="notation">)</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">N.pow_succ_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="keyword">∀</span> <a id="n:37" class="idref" href="#n:37"><span class="id" title="binder"><span id="n:39" class="id">n</span></span></a> <a id="m:38" class="idref" href="#m:38"><span class="id" title="binder"><span id="m:40" class="id">m</span></span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>, 2 <span class="id" title="notation">×</span> <a class="idref" href="v2.html#n:37"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&lt;</span> 2 <span class="id" title="notation">×</span> <a class="idref" href="v2.html#m:38"><span class="id" title="variable">m</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="v2.html#n:37"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="v2.html#m:38"><span class="id" title="variable">m</span></a>).<br/>
&nbsp;&nbsp;{ <span class="id" title="var">nia</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hrw</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="annoying_precond_xI" class="idref" href="#annoying_precond_xI"><span class="id" title="lemma">annoying_precond_xI</span></a> : <span class="id" title="keyword">∀</span> <a id="p:41" class="idref" href="#p:41"><span class="id" title="binder">p</span></a> <a id="w:42" class="idref" href="#w:42"><span class="id" title="binder">w</span></a>,<br/>
&nbsp;&nbsp;<span class="id" title="abbreviation">N.pos</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#xI"><span class="id" title="constructor">xI</span></a> <a class="idref" href="v2.html#p:41"><span class="id" title="variable">p</span></a>) <span class="id" title="notation">&lt;</span> 2 <span class="id" title="notation">^</span> <span class="id" title="definition">N.of_nat</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="v2.html#w:42"><span class="id" title="variable">w</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">N.pos</span> <a class="idref" href="v2.html#p:41"><span class="id" title="variable">p</span></a> <span class="id" title="notation">&lt;</span> 2 <span class="id" title="notation">^</span> <span class="id" title="notation">(</span><span class="id" title="definition">N.of_nat</span> <a class="idref" href="v2.html#w:42"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="v2.html#annoying_precond_xO"><span class="id" title="lemma">annoying_precond_xO</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">N.le_lt_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">m</span> := <span class="id" title="abbreviation">N.pos</span> <span class="id" title="var">p</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.BinNums.PosDef.html#119ad21c8e0c4947cd973f1f72e5feea"><span class="id" title="notation">~1</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">nia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="vec_N_roundtrip_0" class="idref" href="#vec_N_roundtrip_0"><span class="id" title="lemma">vec_N_roundtrip_0</span></a> : <span class="id" title="keyword">∀</span> <a id="w:43" class="idref" href="#w:43"><span class="id" title="binder">w</span></a>, <a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <a class="idref" href="v2.html#w:43"><span class="id" title="variable">w</span></a> (<a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> <a class="idref" href="v2.html#w:43"><span class="id" title="variable">w</span></a> 0) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="vec_N_roundtrip" class="idref" href="#vec_N_roundtrip"><span class="id" title="lemma">vec_N_roundtrip</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="w:44" class="idref" href="#w:44"><span class="id" title="binder">w</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="n:45" class="idref" href="#n:45"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Htrunc:46" class="idref" href="#Htrunc:46"><span class="id" title="binder">Htrunc</span></a> : <a class="idref" href="v2.html#n:45"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&lt;</span> 2%<span class="id" title="var">N</span> <span class="id" title="notation">^</span> <span class="id" title="notation">(</span><span class="id" title="definition">N.of_nat</span> <a class="idref" href="v2.html#w:44"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span>),<br/>
&nbsp;&nbsp;<a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <a class="idref" href="v2.html#w:44"><span class="id" title="variable">w</span></a> (<a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> <a class="idref" href="v2.html#w:44"><span class="id" title="variable">w</span></a> <a class="idref" href="v2.html#n:45"><span class="id" title="variable">n</span></a>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="v2.html#n:45"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="v2.html#n_of_zeroes"><span class="id" title="lemma">n_of_zeroes</span></a>. }<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">p</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Hw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">Hcontra</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hcontra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rename</span> <span class="id" title="var">n</span> <span class="id" title="var">into</span> <span class="id" title="var">w'</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw1</span>: <a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">w'</span>) (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="var">p</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.BinNums.PosDef.html#119ad21c8e0c4947cd973f1f72e5feea"><span class="id" title="notation">~1</span></a>)%<span class="id" title="var">positive</span>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">Vector.cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">p</span>%<span class="id" title="var">positive</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw1</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw2</span>: <span class="id" title="keyword">∀</span> <a id="b:47" class="idref" href="#b:47"><span class="id" title="binder"><span id="b:48" class="id">b</span></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">w'</span>) (<span class="id" title="constructor">cons</span> <a class="idref" href="v2.html#bit"><span class="id" title="inductive">bit</span></a> <a class="idref" href="v2.html#b:47"><span class="id" title="variable">b</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">p</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">(</span><a class="idref" href="v2.html#b2n"><span class="id" title="definition">b2n</span></a> <a class="idref" href="v2.html#b:47"><span class="id" title="variable">b</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">+</span> 2 <span class="id" title="notation">×</span> <span class="id" title="notation">(</span><a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">p</span>))<span class="id" title="notation">)</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">reflexivity</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw2</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw3</span> : <a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">w'</span>) (<span class="id" title="abbreviation">N.pos</span> <span class="id" title="var">p</span>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">w'</span>) (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">p</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">reflexivity</span>. }<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Check</span> <a class="idref" href="v2.html#annoying_precond_xI"><span class="id" title="lemma">annoying_precond_xI</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="v2.html#annoying_precond_xI"><span class="id" title="lemma">annoying_precond_xI</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Hw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">Hcontra</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hcontra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rename</span> <span class="id" title="var">n</span> <span class="id" title="var">into</span> <span class="id" title="var">w'</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw1</span>: <a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">w'</span>) (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="var">p</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.BinNums.PosDef.html#35713fcadfdd66af247cbf95acf859fa"><span class="id" title="notation">~0</span></a>)%<span class="id" title="var">positive</span>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">Vector.cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b0"><span class="id" title="constructor">b0</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">p</span>%<span class="id" title="var">positive</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw1</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw2</span>: <span class="id" title="keyword">∀</span> <a id="b:49" class="idref" href="#b:49"><span class="id" title="binder"><span id="b:50" class="id">b</span></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">w'</span>) (<span class="id" title="constructor">cons</span> <a class="idref" href="v2.html#bit"><span class="id" title="inductive">bit</span></a> <a class="idref" href="v2.html#b:49"><span class="id" title="variable">b</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">p</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">(</span><a class="idref" href="v2.html#b2n"><span class="id" title="definition">b2n</span></a> <a class="idref" href="v2.html#b:49"><span class="id" title="variable">b</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">+</span> 2 <span class="id" title="notation">×</span> <span class="id" title="notation">(</span><a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> <span class="id" title="var">w'</span> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">p</span>))<span class="id" title="notation">)</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">reflexivity</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw2</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw3</span> : <a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">w'</span>) (<span class="id" title="abbreviation">N.pos</span> <span class="id" title="var">p</span>) <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="v2.html#vec_of_pos"><span class="id" title="definition">vec_of_pos</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">w'</span>) (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">p</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">reflexivity</span>. }<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">Hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="v2.html#annoying_precond_xO"><span class="id" title="lemma">annoying_precond_xO</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Htrunc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ { <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Check</span> <span class="id" title="constructor">Vector.cons</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">w</span>) 1 <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="constructor">Vector.cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b1"><span class="id" title="constructor">b1</span></a> <span class="id" title="var">w</span> (<a class="idref" href="v2.html#vec_of_N"><span class="id" title="definition">vec_of_N</span></a> <span class="id" title="var">w</span> 0)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="v2.html#vec_z"><span class="id" title="lemma">vec_z</span></a>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="keyword">∀</span> <a id="b:51" class="idref" href="#b:51"><span class="id" title="binder"><span id="b:54" class="id">b</span></span></a> <a id="w:52" class="idref" href="#w:52"><span class="id" title="binder"><span id="w:55" class="id">w</span></span></a> <a id="v:53" class="idref" href="#v:53"><span class="id" title="binder"><span id="v:56" class="id">v</span></span></a>, <a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="v2.html#w:52"><span class="id" title="variable">w</span></a>) (<span class="id" title="constructor">cons</span> <span class="id" title="var">_</span> <a class="idref" href="v2.html#b:51"><span class="id" title="variable">b</span></a> <a class="idref" href="v2.html#w:52"><span class="id" title="variable">w</span></a> <a class="idref" href="v2.html#v:53"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">(</span><a class="idref" href="v2.html#b2n"><span class="id" title="definition">b2n</span></a> <a class="idref" href="v2.html#b:51"><span class="id" title="variable">b</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">+</span> 2 <span class="id" title="notation">×</span> <span class="id" title="notation">(</span><a class="idref" href="v2.html#N_of_vec"><span class="id" title="definition">N_of_vec</span></a> <a class="idref" href="v2.html#w:52"><span class="id" title="variable">w</span></a> <a class="idref" href="v2.html#v:53"><span class="id" title="variable">v</span></a><span class="id" title="notation">)</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">auto</span>. } <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="v2.html#vec_N_roundtrip_0"><span class="id" title="lemma">vec_N_roundtrip_0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;}<br/>
<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>
<hr/>This page has been generated by <a href="http://rocq-prover.org/">coqdoc</a>
</div>

</div>

</body>
</html>